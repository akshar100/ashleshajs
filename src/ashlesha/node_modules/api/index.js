var YUI = require('yui'), email = require('nodemailer'), Y, api={};

exports.setYInstance=function(c){
	Y = c;
};
function login(config){
	
	
	return {
		success:true,
		user:{
			_id:"Someid",
			firstname:"Akshar",
			lastname:"Prabhu Desai",
			email:"akshar@akshar.co.in"
			
		}
	};
}
api.user ={
	is_taken:function(config){
		return {
			taken:false
		};
	}
};

exports.api = function(path,config){
		var out;
		switch(path){
			
			case "/login":
				out = login(config);
				Y.fire("api:"+path,out);
				return out;
			case "/user/is_taken":
				return api.user.is_taken(config);
		}
	
}








var smtpTransport = email.createTransport("SMTP",{
    service: "Gmail",
    auth: {
        user: "akshar@akshar.co.in",
        pass: "inbullsx10.1"
    }
});

var mailOptions = {
    from: "Akshar Prabhu Desai <akshar@e-yantra.org>", // sender address
    to: "akshar@akskah.co.in", // list of receivers
    subject: "Hello ", // Subject line
    text: "Hello world ", // plaintext body
    html: "<b>Hello world </b>" // html body
}

function send_email(){
	smtpTransport.sendMail(mailOptions, function(error, response){
	    if(error){
	        console.log(error);
	    }else{
	        console.log("Message sent: " + response.message);
	    }
	
	    // if you don't want to use this transport object anymore, uncomment following line
	    smtpTransport.close(); // shut down the connection pool, no more messages
	});
}